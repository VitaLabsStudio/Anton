# Story 2.14: Fix TypeScript Build Errors and Remove Duplicate Files

## Status: In Progress

## Story

**As a** developer,
**I want** to eliminate duplicate files and fix TypeScript compilation errors,
**so that** the build pipeline succeeds and automated tests can run reliably for all future stories.

## Acceptance Criteria

1. **No Duplicate Files:** All files with numbered suffixes (e.g., `file 2.ts`, `file 3.ts`) are audited and removed, retaining only the correct version.
2. **Clean Build:** `pnpm tsc --noEmit` completes with 0 errors.
3. **Seed Compatibility:** `database/prisma/seed.ts` successfully seeds the database, respecting the new composite primary key (`id`, `createdAt`) for Decisions.
4. **Prevention:** A pre-commit hook is established to prevent future commits of duplicate numbered files.

---

## Tasks / Subtasks

- [ ] **Task 1: Audit & Remove Duplicate Files** (AC: 1)
   - Identify files matching pattern `* [0-9].*`.
   - Determine the authoritative version (usually the latest or the one without suffix if content matches).
   - Delete redundant files.

- [ ] **Task 2: Fix TypeScript Compilation Errors** (AC: 2)
   - Run `tsc` to identify errors.
   - Fix missing types, invalid imports, and null safety issues.
   - Address specific issues in `decision-engine`, `robust-statistics`, etc.

- [ ] **Task 3: Fix Seed File** (AC: 3)
   - Update `database/prisma/seed.ts` to include `createdAt` in `decision.create` calls.
   - Verify `pnpm prisma db seed` runs without error (if local DB available) or code review confirms compliance.

- [ ] **Task 4: Add Git Pre-Commit Hook** (AC: 4)
   - Configure Husky to check for filenames matching the duplicate pattern.
   - Ensure it rejects the commit if found.

- [ ] **Task 5: Verification** (AC: 2)
   - Confirm `pnpm tsc --noEmit` passes.
   - Confirm `pnpm test` executes all suites.

---

## Dev Notes

- **Duplicate Pattern:** Often caused by copy-paste or cloud sync conflicts.
- **Composite PK:** Story 2.8a changed `Decision` PK to `(id, createdAt)`. All inserts must provide both if `createdAt` isn't defaulted (Prisma `create` often handles default, but seed data might be explicit or using `createMany` which skips defaults in some versions, though here it's likely just missing fields in strict mode). Actually, `createdAt` has a default, but if the seed is trying to define specific dates or if the type definition requires it due to how the client was generated, we must ensure compliance.

## File List
- (To be populated)